<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generation One â€“ From Ashes</title>
  <link rel="stylesheet" href="style.css" />
<script src="wheel.js" defer></script>
<script src="worldpicker.js" defer></script>
<script src="traits.js" defer></script>

</head>
<body>
  <header>
    <h1>ğŸŒ± Generation One â€“ From Ashes</h1>
    <nav>
      <a href="index.html">Home</a>
    </nav>
  </header>
  <div class="content-wrapper">
    <main>
    <section>
      <h2>ğŸ“¦ Gen One Overview</h2>
      <ul>
        <li><strong>ğŸ¯ Pack Focus:</strong> Base Game Only</li>
        <li><strong>ğŸ”¥ Theme:</strong> Off-the-grid survival, emotional scars, rebuilding legacy</li>
        <li><strong>ğŸ¨ Color Palette:</strong> Burnt Sienna Â· Olive Green Â· Charcoal Grey Â· Faded Linen</li>
        <li><strong>ğŸ›‹ï¸ Interior Style:</strong> Rustic Minimalism Â· Wasteland Survival Â· Handcrafted Solitude</li>
      </ul>
    </section>
    <section>
  <h2>ğŸ² World & Backstory Selector</h2>
  <p>Click to randomly reveal your Simâ€™s origin story and survival setting:</p>
  <button onclick="rollWorld()">Roll World</button>
  <pre id="worldResult" style="white-space: pre-wrap; background: #1e1e1e; padding: 15px; border-left: 4px solid #F00081; border-radius: 6px; margin-top: 15px;"></pre>
</section>

    <section>
  <h2>ğŸ¡ Spin-to-Survive: The Triple Skill Challenge</h2>
  <p>Click the button <strong>three times</strong> to receive your Simâ€™s random skills:</p>
  <button onclick="spinSkill()">Spin Skill</button>
  <ul id="skillResults" style="margin-top: 10px;"></ul>
</section>

    
<section>
  <h2>ğŸ§ Create Your Sim</h2>

  <label for="simName">Name Your Founder:</label><br>
  <input type="text" id="simName" placeholder="e.g., Elara Moss" /><br><br>
  <label for="simImage">ğŸ“¸ Upload Founder Image:</label><br>
 <input type="file" id="simImage" accept="image/*"><br><br>
 <img id="simPreview" alt="Sim Preview" style="max-width: 200px; display: none; border-radius: 6px; border: 1px solid #888;" /><br><br>

  <label>ğŸ² Trait 1:</label><br>
  <select id="trait1"></select><br><br>

  <label>ğŸ² Trait 2:</label><br>
  <select id="trait2"></select><br><br>

  <label>ğŸ² Trait 3 (linked to skills):</label><br>
  <select id="trait3"></select><br><br>

  <button id="rollAllTraits">Roll Traits</button>
</section>

<section>
  <h2>ğŸ’³ Sim ID Card</h2>
  <canvas id="simIdCanvas" width="1011" height="639" style="max-width: 100%; border: 1px solid #ccc; border-radius: 8px;"></canvas>
  <button onclick="generateSimIDCard()">ğŸ« Generate ID Card</button>
  <button onclick="downloadSimIDCard()">â¬‡ï¸ Download Card</button>
</section>


    <section>
      <h2>ğŸšï¸ Lot Setup</h2>
      <ul>
        <li>Start with <strong>Â§0</strong></li>
        <li>Bulldozed residential lot</li>
        <li>No furniture or structures</li>
        <li>No cheats</li>
      </ul>
      <h3>ğŸ› ï¸ Required Lot Traits:</h3>
      <ul>
        <li>âœ… <strong>Off the Grid</strong> (mandatory)</li>
        <li>ğŸ”¸ 1 Challenge Trait: Filthy, Grody, Quake Zone, Volcanic Activity (cheat), Creepy Crawlies (mod)</li>
        <li>ğŸ”¹ 1 Helpful Trait: Homey, Sunny Aspect, Great Soil, Fast Internet (only if earned)</li>
      </ul>
    </section>


      <section>
        <h2>ğŸ” Challenge Restrictions</h2>
        <ul>
          <li>âŒ No careers or freelance gigs</li>
          <li>âŒ No selling unrelated items</li>
          <li>âŒ No modern power/plumbing</li>
          <li>âœ… Use off-the-grid Base Game items: dew collectors, composting toilets, candles, solar panels (if earned)</li>
        </ul>
      </section>

      <section>
        <h2>ğŸ¯ Generation Completion Goals</h2>
        <ul>
          <li><input type="checkbox"> Max 3 skills</li>
          <li><input type="checkbox"> Complete 3 aspirations</li>
          <li><input type="checkbox"> Reach Â£150,000 value</li>
          <li><input type="checkbox"> Build an off-the-grid home</li>
          <li><input type="checkbox"> Create a Legacy Vault with:
            <ul>
              <li><input type="checkbox"> ğŸ–¼ï¸ Family portrait of Gen 1 & Gen 2</li>
              <li><input type="checkbox"> ğŸ“¦ 3 skill-based heirlooms</li>
            </ul>
          </li>
          <li><input type="checkbox"> Have or adopt an heir</li>
          <li><input type="checkbox"> Heir must witness trauma (death, fire, betrayal)</li>
        </ul>
      </section>

      <section>
        <h2>ğŸ§³ï¸ Legacy Vault Tradition</h2>
        <ul>
          <li>Create a hidden room (attic, basement, or vault)</li>
          <li>Lock it for Gen 2 only</li>
          <li>Store heirlooms and the family portrait</li>
          <li>Pass this space through generations</li>
        </ul>
      </section>

      <section>
        <h2>ğŸ’¬ Final Prompt: The Founderâ€™s Message</h2>
        <p>Your Sim must leave a legacy message:</p>
        <blockquote><em>â€œThis is where we began. Whatever you build next, donâ€™t forget where we came from.â€</em></blockquote>
      </section>
    </main>
  </div>

  <footer>
    <p>&copy; 2025 CandyBlack â€“ Sims 4 Legacy Challenge</p>
  </footer>

  <audio id="rollSound" src="roll.mp3" preload="auto"></audio>

<script>
  // Helper: Populate dropdown with given trait options
  function populateTraitDropdown(select, options) {
    select.innerHTML = "";
    options.forEach(trait => {
      const opt = document.createElement("option");
      opt.value = trait;
      opt.textContent = trait;
      select.appendChild(opt);
    });
  }

  // DOM Init: Single listener for all setup
  document.addEventListener("DOMContentLoaded", () => {
    // Restore checkboxes from localStorage
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach((box, index) => {
      const key = `gen1-check-${index}`;
      box.checked = localStorage.getItem(key) === 'true';
      box.addEventListener('change', () => {
        localStorage.setItem(key, box.checked);
      });
    });

    // Restore Sim name
    const nameInput = document.getElementById("simName");
    nameInput.value = localStorage.getItem("simName") || "";
    nameInput.addEventListener("input", e => {
      localStorage.setItem("simName", e.target.value);
    });

    // Roll traits button
    const rollButton = document.getElementById("rollAllTraits");
    if (rollButton) {
      rollButton.addEventListener("click", rollAllTraitsFromSkills);
    }

    // Populate dropdowns if stored
    ["trait1", "trait2", "trait3"].forEach(id => {
  const select = document.getElementById(id);
  const savedValue = localStorage.getItem(id);

  if (select && savedValue) {
    if (![...select.options].some(opt => opt.value === savedValue)) {
      const opt = document.createElement("option");
      opt.value = savedValue;
      opt.textContent = savedValue;
      select.appendChild(opt);
    }
    select.value = savedValue;
  }
});
  });
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const imageInput = document.getElementById("simImage");
  const preview = document.getElementById("simPreview");

  // Load from storage if exists
  const storedImage = localStorage.getItem("simImage");
  if (storedImage) {
    preview.src = storedImage;
    preview.style.display = "block";
  }

  // When a new image is selected
  imageInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(event) {
      const imageData = event.target.result;
      preview.src = imageData;
      preview.style.display = "block";
      localStorage.setItem("simImage", imageData);
    };
    reader.readAsDataURL(file);
  });
});
</script>
<script>
function generateSimIDCard() {
  const canvas = document.getElementById("simIdCanvas");
  const ctx = canvas.getContext("2d");

  canvas.width = 1011;
  canvas.height = 639;

  const bg = new Image();
  bg.src = "SimID.png"; // Background image path

  bg.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);

    const simImageData = localStorage.getItem("simImage");

    const name = localStorage.getItem("simName") || "Unnamed Sim";
    const trait1 = localStorage.getItem("trait1") || "-";
    const trait2 = localStorage.getItem("trait2") || "-";
    const trait3 = localStorage.getItem("trait3") || "-";
    const worldRaw = document.getElementById("worldResult")?.innerText || "";
    const world = worldRaw.split("â€“")[1]?.trim().split("\n")[0] || "Unknown World";
    const skills = window.rolledSkills || ["-", "-", "-"];

function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
  ctx.textAlign = "center"; // Center alignment
  const words = text.split(" ");
  let line = "";
  let currentY = y;

  for (let i = 0; i < words.length; i++) {
    const testLine = line + words[i] + " ";
    const testWidth = ctx.measureText(testLine).width;

    if (testWidth > maxWidth && i > 0) {
      ctx.fillText(line.trim(), x, currentY);
      line = words[i] + " ";
      currentY += lineHeight;
    } else {
      line = testLine;
    }
  }

  // Draw the last line
  ctx.fillText(line.trim(), x, currentY);
}


    function drawTextContent() {
  const textX = 370;
  const baseY = 160;
  const lineHeight = 50;

  // ğŸŸ£ Name
  ctx.textAlign = "left";
  ctx.font = "bold 52px Arial";
  ctx.fillStyle = "#f00081";
  ctx.fillText(name, textX, baseY);

  // ğŸ“ World
  ctx.font = "bold 26px Arial";
  ctx.fillStyle = "#000";
  ctx.fillText("ğŸ“ Location : " + world, textX, baseY + lineHeight + 20);

// ğŸ§¬ Traits label
ctx.textAlign = "left";
ctx.font = "bold 26px Arial";
ctx.fillText("ğŸ§¬ Traits :", textX, baseY + lineHeight * 3.1);

// Trait values (centered wrap just to the right of label)
ctx.font = "24px Arial";
ctx.textAlign = "center";
wrapText(
  ctx,
  `${trait1}, ${trait2}, ${trait3}`,
  textX + 360,                  // â¬…ï¸ was 160 â€” now moved more right
  baseY + lineHeight * 3.1,
  460,
  30
);

// ğŸ“ Skills label
ctx.textAlign = "left";
ctx.font = "bold 26px Arial";
ctx.fillText("ğŸ“ Skills :", textX, baseY + lineHeight * 5.2);

// Skills values
ctx.font = "24px Arial";
ctx.textAlign = "left";
wrapText(
  ctx,
  skills.join(", "),
  textX + 360,                 // â¬…ï¸ was 140 â€” now nudged slightly more right
  baseY + lineHeight * 5.2,
  500,
  30
);



  // ğŸ–¼ï¸ Color Palette & Style (centered)
  ctx.font = "20px Arial";
  ctx.textAlign = "center";
  const shiftX = 20;
  const offsetY = 30;

  ctx.fillText(
    "ğŸ¨ Color Palette: Burnt Sienna Â· Olive Green Â· Charcoal Grey Â· Faded Linen",
    canvas.width / 2 + shiftX,
    baseY + lineHeight * 6.3 + offsetY
  );

  ctx.fillText(
    "ğŸ›‹ï¸ Interior Style: Rustic Minimalism Â· Wasteland Survival Â· Handcrafted Solitude",
    canvas.width / 2 + shiftX,
    baseY + lineHeight * 7 + offsetY
  );
}


    if (simImageData) {
      const simPic = new Image();
      simPic.onload = () => {
        ctx.save();
        ctx.beginPath();
        ctx.arc(210, 300, 150, 0, Math.PI * 2, true); // Circular mask
        ctx.closePath();
        ctx.clip();

        ctx.drawImage(simPic, 60, 150, 300, 300); // Sim image
        ctx.restore();

        drawTextContent();
      };
      simPic.src = simImageData;
    } else {
      drawTextContent();
    }
  };
}

</script>


